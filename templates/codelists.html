{% extends 'base.html' %}
{% import 'boxes.html' as boxes %}
{% block content %}
    <div class="panel panel-default">
    <div class="panel-body">
      <p>Count of the different values used by all publishers, per codelist.</p> 
      <p>Note: some Elements/Attributes may use the same codelist.  In each case, the values counted are different for each use.</p>
    </div>
    <table class="table table-striped">
      <thead><tr>
        <th>Element/Attribute on codelist</th>
        <th>Codelist</th>
        <th>Total Values Used <a href="{{stats_url}}/current/inverted-publisher/codelist_values.json">(J)</a></th>
        <th>Total Values on Codelist</th>
        <th>Values used, on Codelist</th>
        <th>Values uesd, not on Codelist</th>
      </tr></thead>
      <tbody>
        {% for i, (element, values) in enumerate(current_stats.inverted_publisher.codelist_values.items()) %}
            <tr>
                <td><a href="codelist/{{slugs.codelist.by_i[i]}}.html">{{element}}</td>
                <td><a href="http://iatistandard.org/codelists/{{codelist_mapping.get(element)}}">{{codelist_mapping.get(element)}}</a></td>
                <td><a href="codelist/{{slugs.codelist.by_i[i]}}.html">{{values|length}}</a></td>
                <td><a href="http://iatistandard.org/codelists/{{codelist_mapping.get(element)}}">{{codelist_sets.get(codelist_mapping.get(element))|length}}</a></td>
                {% with codes=sorted(codelist_sets.get(codelist_mapping.get(element)).intersection(values.keys())) %}
                <td><a href="codelist/{{slugs.codelist.by_i[i]}}.html">{{codes|length}}</a></td>
                {% endwith %}
                {% with codes=sorted(set(values.keys()).difference(codelist_sets.get(codelist_mapping.get(element)))) %}
                <td><a href="codelist/{{slugs.codelist.by_i[i]}}.html">{{codes|length}}</a></td>
                {% endwith %}
            </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>

{% endblock %}
